# ImageStitching
A set of functions that can stitch together 2 images using manual or automatically generated keypoints

# usage
## Step 0:View transformation
To view the transformation run 
```console
foo@bar:~$ python3 demo.py 
foo
```
you will be asked to click on 4 corresponding keypoints alternatively and sequentially and these coordinates will be saved in 
params folder as "A.npy" and "B.npy" corresponding to the Wide and Zoom images and also the homography matrix H as "H.npy". 
3 windows will pop up corresponding to the wide, zoom and the warped image generated by transforming the zoom image to the homography
of the wide angle image.

To proceed further please follow the following steps in sequence
## Step 1: Generate Homography matrix
To generate the homography matrix, given 2 rtsp feeds, run the 
```console
foo@bar:~$ python3 ManualStitching.py 
foo
```
once the homography matrix is generated, it is stored in the params folder as a .npy file named "H.params"
you will be asked to click on 4 corresponding keypoints alternatively and sequentially and these coordinates will be saved in 
params folder as "A.npy" and "B.npy" corresponding to the Wide and Zoom images and also the homography matrix H as "H.npy"
## Step 2: Use the homography matrix to transform the image and bbox coordinates
Once you have generated the homography matrix H in either step 0 or/and verified it in step 1, Load the homography matrix in a numpy array as 
```python
import numpy as np
H = np.load("./params/H.npy")
```

To transform your own image and bbox coordinates use the trasform function in Transform.py
```python
def transform(list_bbox, zoom_image, wide_image, H):
    '''
    Returns the transformed image and bbox coordinates given 
    a homography matrix H
    Args:
        list_bbox (List): a list of numpy array [ [[x1,y1],[x2,y2]].... ]
        image (np.ndarray): a 3 channel ncv2 image
        H (np.ndarray): the homography matrix required for the warp
    Returns:
        A list of warped bbox coordinates and the transformed 3 channel cv2 image
    '''
```
The aforementioned function returns the transformed bbox coordinates (given and returned in matrix diagonal form), and also the transformed image.
